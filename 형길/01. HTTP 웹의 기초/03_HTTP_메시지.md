# 3장. HTTP 메시지

<br>

## 소개

<br>

이번 장을 통해 HTTP 메시지의 모든 것(어떻게 메시지를 만들고 이해하는지)에 대해 알아보자.

- 메시지가 어떻게 흘러가는가

- HTTP 메시지의 세 부분(시작줄, 헤더, 개체 본문)

- 요청과 응답 메시지의 차이

- 요청 메시지가 지원하는 여러 기능(메서드)들

- 응답 메시지가 반환하는 여러 상태 코드들

- 여러 HTTP 헤더들은 무슨 일을 하는가


<br><br>

## 3.1 메시지의 흐름

- HTTP 메시지는 HTTP 애플리케이션 간에 주고받은 데이터의 블록들이다.

- 이 메시지는 클라이언트, 서버, 프록시 사이를 흐른다.

- 인바운드, 아웃바운드, 업스트림, 다운스트림이라는 방향을 의미하는 용어를 사용한다.

<br><br>

### 3.1.1 메시지는 원 서버 방향을 인바운드로 하여 송신된다.

- 메시지가 `원 서버로 항하는 것은 인바운드`로 이동하는 것이다.

-  모든 처리가 끝난 뒤에 메시지가 `사용자 에이전트로 돌아오는 것은 아웃바운드`로 이동하는 것이다.

<br>

### 3.1.2 다운스트림으로 흐르는 메시지

- 요청 메시지냐 응답 메시지냐에 관계없이 `모든 메시지는 다운스트림으로 흐른다.` 결코 업스트림으로 흐르지 않는다.

<br><br>

## 3.2 메시지의 각 부분

- HTTP 메시지는 단순한, 데이터의 구조화된 블록이다.

- 각 메시지는 클라이언트로부터의 요청이나 서버로부터의 응답 중 하나를 포함한다.

- 시작줄, 헤더 블록, 본문 세 부분으로 이루어진다.

    - 시작줄은 이것이 어떤 메시지인지 서술한다.

    - 헤더 블록은 속성을 서술한다.

    - 본문은 데이터를 담고 있다. 없을 수도 있다.

<br><br>

### 3.2.1 메시지 문법

<br>

<p align="center"><img src="../images/HTTP_트랜잭션.png" width="80%"></p>

<br>

- 모든 HTTP 메시지는 요청 메시지나 응답 메시지로 분류된다.

- 요청 메시지

    <메서드> <요청 URL> <버전>
    <br>
    <헤더>
    <br><br>
    <엔터티 본문>

<br>

- 응답 메시지

    <버전> <상태 코드> <사유 구절>
    <br>
    <헤더>
    <br><br>
    <엔터티 본문>

<br>

- 메서드

    `클라이언트 측에 서버가 리소스에 대해 수행해주길 바라는 동작`이다.

    GET, POST, PUT 과 같이 한 단어로 되어 있다.

<br>

- 요청 URL

    `요청 대상이 되는 리소스를 지칭하는 완전한 URL 혹은 URL의 경로 구성요소`이다.

<br>

- 버전

    이 메시지에서 사용중인 HTTP의 버전이다.

    HTTP/<메이저>.<마이너>

<br>

- 상태 코드

    요청 중에 무엇이 일어났는지 설명하는 세 자리의 숫자다.

    첫 번째 자릿수는 상태의 일반적인 분류(성공, 에러 등)을 나타낸다.

<br>

- 사유 구절

    상태 코드를 사람이 이해할 수 있게 설명해주는 짧은 문구로 오로지 사람에게 읽히기 위한 목적이기에 사유 구절로 인해 응답에 영향이 가진 않는다.

    HTTP/1.0 200 OK

<br>

- 헤더들

    빈 줄(CRLF)로 끝나 헤더 목록의 끝과 엔터티 본문의 시작을 표시한다.

<br>

- 엔터티 본문

    임의의 데이터 블록을 포함한다. 모든 메시지가 엔터티 본문을 갖는 것은 아니므로, 때때로 메시지는 그냥 CRLF로 끝나게 된다.

<br><br>

### 3.2.2 시작줄

- 모든 HTTP 메시지는 시작줄로 시작한다.

<br>

- 요청줄 

    요청 메시지는 서버에게 리소스에 대해 무언가를 해달라고 부탁한다.

    서버에서 어떤 동작이 일어나야 하는지 설명해주는 메서드와 그 동작에 대한 대상을 지칭하는 요청 URL이 들어있다.

<br>

- 응답줄

    응답 메시지는 수행 결과에 대한 상태 정보와 결과 데이터를 클라이언트에게 돌려준다.


    HTTP의 버전, 상태 코드, 사유 구절이 들어있다.

<br>

- 메서드

    요청의 시작줄은 메서드로 시작하며, 서버에게 무엇을 해야 하는지 말해준다.

    예를 들어, 'GET /speicals/saw-blade.gif HTTP/1.0'에서 메서드는 GET이다.

    | 메서드 | 설명 | 메시지 본문이 있는가? |
    | --- | --- | --- |
    | GET | 서버에서 어떤 문서를 가져온다. | 없음 |
    | HEAD | 서버에서 어떤 문서에 대한 헤더만 가져온다. | 없음 |
    | POST | 서버가 처리해야 할 데이터를 보낸다. | 있음 |
    | PUT | 서버에 요청 메시지의 본문을 저장한다. | 있음 |
    | TRACE | 메시지가 프록시를 거쳐 서버에 도달하는 과정을 추적한다. | 없음 |
    | OPTIONS | 서버가 어떤 메서드를 수행할 수 있는지 확인한다. | 없음 |
    | DELETE | 서버에서 문서를 제거한다. | 없음 |

<br>

- 상태 코드

    클라이언트에게 무엇이 일어났는지 말해준다.

    | 전체 범위 | 정의된 범위 | 분류 |
    | --- | --- | --- |
    | 100 ~ 199 | 100 ~ 101 | 정보 |
    | 200 ~ 299 | 200 ~ 206 | 성공 |
    | 300 ~ 399 | 300 ~ 305 | 리다이렉션 |
    | 400 ~ 499 | 400 ~ 415 | 클라이언트 에러 |
    | 500 ~ 599 | 500 ~ 505 | 서버 에러 |

    <br>

    많이 쓰이는 상태 코드들

    | 상태 코드 | 사유 구절 | 의미 |
    | --- | --- | --- |
    | 200 | OK | 성공! 요청한 모든 데이터는 응답 본문에 들어있다. |
    | 401 | Unauthorized | 사용자 이름과 비밀번호를 입력해야 한다. |
    | 404 | Not Found | 서버는 요청한 URL에 해당하는 리소스를 찾지 못했다. |
    | 400 | Bad Request | 사용자의 잘못된 요청 |
    | 500 | Internet Sever Error | 서버 내부 에러 |

<br>

- 사유 구절

    상태 코드에 대한 글로 된 설명을 제공한다.

<br>

- 버전 번호

    HTTP 애플리케이션들이 자신이 따르는 프로토콜의 버전을 상대방에게 말해주기 위한 수단

<br><br>

### 3.2.3 헤더

- HTTP 헤더 필드는 요청과 응답 메시지에 추가 정보를 더한다.

    ex) Content-length: 19, Content-Type: image/gif

<br>

- 헤더 분류

    - 일반 헤더

        요청과 응답 양쪽에 모두 나타날 수 있음 

    <br>

    - 요청 헤더

        요청에 대한 부가 정보를 제공

    <br>
    
    - 응답 헤더

        응답에 대한 부가 정보를 제공

    <br>

    - Entity 헤더

        본문 크기와 콘텐츠, 혹은 리소스 그 자체를 서술

    <br>

    - 확장 헤더

        명세에 정의되지 않은 새로운 헤더

    | 헤더의 예 | 설명 |
    | --- | --- | 
    | Date: Tue, 3 Oct 2023 | 서버가 응답을 만들어 낸 시각 | 
    | Content-length: 15040 | 15,040바이트의 데이터를 포함한 엔터티 본문 | 
    | Content-type: image/gif | 엔터티 본문은 GIF 이미지이다. | 
    | Accept: image/gif, image/jpeg, text/html | 클라이언트는 GIF, JPEG 이미지와 HTML을 받아들일 수 있다. |

    <br><br>

### 3.2.4 엔터티 본문

- 엔터티 본문은 HTTP 메시지의 화물이며, 이미지, 비디오, HTML 문서 등 여러 종류의 디지털 데이터를 실어 나를 수 있다.

<br><br>

## 3.3 메서드




    